# 版本保留政策 (Version Retention Policy)

## 🎯 保留策略概述 - 分層數量限制

採用分層數量限制策略，確保版本數量可控的同時保留重要歷史版本。

## 📋 分層保留規則

### 🏆 永久保留 (Permanent Retention) - 不限數量
- **當前穩定版本**: 在 `STABLE_VERSION.md` 中標記的穩定版本
- **重大里程碑版本**: 具有重要功能突破或修復的版本
- **定期評估**: 每季度評估是否仍需永久保留

### 🔄 長期保留 (Long-term Retention) - 最多6個
- **功能里程碑**: 重要功能版本，按重要性排序保留最重要的6個
- **架構變更版本**: 涉及重大技術架構變更的版本
- **修復關鍵問題**: 修復重要問題的版本
- **自動淘汰**: 超過6個時，自動淘汰最不重要的版本

### ⏰ 短期保留 (Short-term Retention) - 固定3個
- **最近3個版本**: 保留最新的3個版本用於快速回滾
- **滾動更新**: 新版本發布時，自動淘汰最舊的短期保留版本

### 🗑️ 自動清理 (Auto Cleanup)
- **中間開發版本**: 不符合上述分類的版本
- **測試版本**: 純測試用途的版本
- **重複功能版本**: 功能重複且沒有獨特價值的版本

## 📊 當前版本分類與調整 (v1.0.2.0378)

### 🏆 永久保留 (1個)
| 版本號 | 保留原因 |
|--------|----------|
| **v1.0.2.0378** | 當前穩定版，系統性回滾穩定版 |

### ⏰ 短期保留 (3個) - 最近版本
| 版本號 | 保留原因 |
|--------|----------|
| **v1.0.2.0377** | 最近版本 #1 |
| **v1.0.2.0373** | 最近版本 #2 |
| **v1.0.2.0372** | 最近版本 #3 |

### 🔄 長期保留 (6個) - 按重要性排序
| 版本號 | 重要性 | 保留原因 |
|--------|--------|----------|
| **v1.0.2.0371** | ⭐⭐⭐⭐⭐ | 隱蔽後門雲端修復，重要功能突破 |
| **v1.0.2.0361** | ⭐⭐⭐⭐ | Vercel Edge Functions 整合，架構變更 |
| **v1.0.2.0336** | ⭐⭐⭐ | 重要功能版本 |
| **v1.0.2.0299** | ⭐⭐⭐ | 功能里程碑版本 |
| **v1.0.2.0261** | ⭐⭐ | 早期穩定版本 |
| **v1.0.2.0240** | ⭐⭐ | 早期里程碑版本 |

### ❌ 已清理的版本 (5個)
| 版本號 | 清理原因 |
|--------|----------|
| **v1.0.2.0363** | 中間開發版本，功能重複 |
| **v1.0.2.0356** | 測試版本，已被後續版本取代 |
| **v1.0.2.0349** | 中間開發版本，沒有重要功能 |
| **v1.0.2.0337** | 短期開發版本，已被修復 |
| **v1.0.2.0282** | 早期開發版本，功能已整合 |

## 📈 版本數量控制

### 當前狀態
- **總版本數**: 10個 (1永久 + 3短期 + 6長期)
- **目標範圍**: 8-12個版本
- **狀態**: ✅ 符合目標範圍

### 未來管理規則

#### 新版本發布時
1. **新穩定版本** → 更新永久保留，舊穩定版本降級為長期保留
2. **新功能版本** → 評估是否進入長期保留，如超過6個則淘汰最不重要的
3. **新開發版本** → 進入短期保留，淘汰最舊的短期保留版本

#### 長期保留版本管理
當長期保留版本超過6個時，按以下優先級淘汰：
1. **重要性評分最低**的版本
2. **時間最久遠**且功能已被取代的版本
3. **功能重複**的版本

## 🛠️ 自動化管理

### 清理腳本更新
```bash
# 執行分層數量限制清理
scripts\cleanup-old-releases.bat
```

### 檢查規則
- **永久保留**: 1-2個 (當前穩定版 + 前一個穩定版)
- **長期保留**: 最多6個 (按重要性排序)
- **短期保留**: 固定3個 (最近版本)
- **總數控制**: 8-12個版本

## 🔄 定期維護

### 每月檢查
- [ ] 檢查短期保留版本是否需要升級為長期保留
- [ ] 評估長期保留版本的重要性排序
- [ ] 執行自動清理腳本

### 每季度檢查
- [ ] 重新評估永久保留版本的必要性
- [ ] 調整長期保留版本的重要性評分
- [ ] 檢查總版本數量是否在目標範圍內

### 年度檢查
- [ ] 全面檢視版本保留策略效果
- [ ] 更新重要性評估標準
- [ ] 考慮歸檔超舊版本到外部儲存

## 📊 預期效果

### 版本數量控制
- **最少**: 8個版本 (1永久 + 3短期 + 4長期)
- **最多**: 12個版本 (2永久 + 3短期 + 7長期)
- **平均**: 10個版本 (1永久 + 3短期 + 6長期)

### 磁碟空間
- **每個版本**: 約30-40MB
- **總空間**: 240-480MB
- **可控範圍**: 有效控制磁碟使用

## 🎯 政策優勢

1. **數量可控**: 嚴格控制版本總數在合理範圍
2. **重要性保證**: 確保重要版本不會被意外清理
3. **自動管理**: 減少手動判斷和維護工作
4. **靈活調整**: 可根據實際需要調整各層數量限制

---

**制定日期**: 2026-01-31  
**版本**: v2.0.0 (分層數量限制版)  
**適用範圍**: 本機端開發環境  
**下次檢視**: 2026-02-28