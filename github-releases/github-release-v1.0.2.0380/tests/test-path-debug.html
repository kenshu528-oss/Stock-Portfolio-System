<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¯å¾‘èª¿è©¦æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .info { background: #d1ecf1; color: #0c5460; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
        button { background: #007cba; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ” è·¯å¾‘èª¿è©¦æ¸¬è©¦</h1>
    
    <h3>ç•¶å‰ä½ç½®è³‡è¨Š</h3>
    <button onclick="showLocationInfo()">é¡¯ç¤ºä½ç½®è³‡è¨Š</button>
    <div id="location-result"></div>
    
    <h3>æ¸¬è©¦ä¸åŒè·¯å¾‘</h3>
    <button onclick="testAllPaths()">æ¸¬è©¦æ‰€æœ‰å¯èƒ½è·¯å¾‘</button>
    <div id="path-result"></div>
    
    <script>
        function showLocationInfo() {
            const resultDiv = document.getElementById('location-result');
            const info = {
                href: window.location.href,
                pathname: window.location.pathname,
                origin: window.location.origin,
                protocol: window.location.protocol
            };
            
            let result = 'ğŸ“ ç•¶å‰ä½ç½®è³‡è¨Š:\n\n';
            for (const [key, value] of Object.entries(info)) {
                result += `${key}: ${value}\n`;
            }
            
            resultDiv.className = 'result info';
            resultDiv.style.whiteSpace = 'pre-wrap';
            resultDiv.textContent = result;
        }
        
        async function testAllPaths() {
            const resultDiv = document.getElementById('path-result');
            resultDiv.className = 'result info';
            resultDiv.textContent = 'ğŸ” æ¸¬è©¦æ‰€æœ‰å¯èƒ½çš„è·¯å¾‘...';
            
            // åŸºæ–¼ç•¶å‰ä½ç½®è¨ˆç®—å¯èƒ½çš„è·¯å¾‘
            const currentPath = window.location.pathname;
            console.log('ç•¶å‰è·¯å¾‘:', currentPath);
            
            const pathsToTest = [
                // ç›¸å°è·¯å¾‘
                '../public/stock_list.json',
                '../../public/stock_list.json', 
                '../stock_list.json',
                './stock_list.json',
                'stock_list.json',
                
                // çµ•å°è·¯å¾‘
                '/public/stock_list.json',
                '/stock_list.json',
                
                // å®Œæ•´ URLï¼ˆå¦‚æœæ˜¯ http å”è­°ï¼‰
                window.location.origin + '/public/stock_list.json',
                window.location.origin + '/stock_list.json'
            ];
            
            let results = 'ğŸ“ è·¯å¾‘æ¸¬è©¦çµæœ:\n\n';
            let successCount = 0;
            
            for (const path of pathsToTest) {
                try {
                    console.log('æ¸¬è©¦è·¯å¾‘:', path);
                    const response = await fetch(path, { 
                        method: 'HEAD',
                        cache: 'no-cache'
                    });
                    
                    const status = response.ok ? 'âœ… æˆåŠŸ' : `âŒ å¤±æ•— (${response.status})`;
                    results += `${path}\n  â†’ ${status}\n\n`;
                    
                    if (response.ok) {
                        successCount++;
                        // å¦‚æœæˆåŠŸï¼Œå˜—è©¦ç²å–å…§å®¹
                        try {
                            const dataResponse = await fetch(path);
                            const data = await dataResponse.json();
                            results += `  ğŸ“Š è³‡æ–™: ${data.count} è‚¡ç¥¨, æ—¥æœŸ: ${data.date}\n\n`;
                        } catch (e) {
                            results += `  âš ï¸ ç„¡æ³•è§£æ JSON: ${e.message}\n\n`;
                        }
                    }
                    
                } catch (error) {
                    results += `${path}\n  â†’ âŒ éŒ¯èª¤: ${error.message}\n\n`;
                }
            }
            
            results += `\nğŸ“Š ç¸½çµ: ${successCount}/${pathsToTest.length} è·¯å¾‘æˆåŠŸ`;
            
            if (successCount > 0) {
                resultDiv.className = 'result success';
            } else {
                resultDiv.className = 'result error';
                results += '\n\nğŸ’¡ å»ºè­°:\n';
                results += '1. ç¢ºèªæª”æ¡ˆæ˜¯å¦å­˜åœ¨æ–¼ public/ ç›®éŒ„\n';
                results += '2. ä½¿ç”¨é–‹ç™¼ä¼ºæœå™¨ (npm run dev) è€Œéç›´æ¥é–‹å•Ÿæª”æ¡ˆ\n';
                results += '3. æª¢æŸ¥ç€è¦½å™¨ Console æ˜¯å¦æœ‰ CORS éŒ¯èª¤';
            }
            
            resultDiv.style.whiteSpace = 'pre-wrap';
            resultDiv.textContent = results;
        }
    </script>
</body>
</html>