<!DOCTYPE html>
<html>
<head>
    <title>Debug Token</title>
</head>
<body>
    <h1>Token Debug</h1>
    <button onclick="checkToken()">檢查 Token</button>
    <div id="result"></div>

    <script>
        function checkToken() {
            const resultDiv = document.getElementById('result');
            
            // 檢查環境變數
            const envToken = import.meta.env?.VITE_DEV_TOKEN;
            const hardcodedToken = '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';
            
            resultDiv.innerHTML = `
                <p><strong>環境變數 Token:</strong> ${envToken || '未設定'}</p>
                <p><strong>硬編碼 Token:</strong> ${hardcodedToken}</p>
                <p><strong>實際使用的 Token:</strong> ${envToken || hardcodedToken}</p>
                <p><strong>Token 長度:</strong> ${(envToken || hardcodedToken).length}</p>
                <p><strong>Token 開頭:</strong> ${(envToken || hardcodedToken).substring(0, 20)}...</p>
            `;
            
            // 測試 API
            testAPI(envToken || hardcodedToken);
        }
        
        async function testAPI(token) {
            try {
                console.log('Testing with token:', token.substring(0, 20) + '...');
                
                // 測試 Bearer 格式
                const bearerResponse = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                console.log('Bearer format response:', bearerResponse.status);
                
                if (bearerResponse.ok) {
                    const user = await bearerResponse.json();
                    document.getElementById('result').innerHTML += `<p style="color: green;">✅ Bearer 格式成功: ${user.login}</p>`;
                    return;
                }
                
                // 測試 token 格式
                const tokenResponse = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                console.log('Token format response:', tokenResponse.status);
                
                if (tokenResponse.ok) {
                    const user = await tokenResponse.json();
                    document.getElementById('result').innerHTML += `<p style="color: green;">✅ Token 格式成功: ${user.login}</p>`;
                    return;
                }
                
                document.getElementById('result').innerHTML += `<p style="color: red;">❌ 兩種格式都失敗: Bearer(${bearerResponse.status}), Token(${tokenResponse.status})</p>`;
                
            } catch (error) {
                document.getElementById('result').innerHTML += `<p style="color: red;">❌ 錯誤: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>