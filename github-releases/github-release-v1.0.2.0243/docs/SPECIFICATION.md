# Stock Portfolio System è¦æ ¼æ–‡æª”

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

### åŸºæœ¬è³‡è¨Š
- **å°ˆæ¡ˆåç¨±**: Stock Portfolio System
- **ç‰ˆæœ¬**: v1.0.2.0221
- **é¡å‹**: ç¾ä»£åŒ–è‚¡ç¥¨æŠ•è³‡çµ„åˆç®¡ç†ç³»çµ±
- **æŠ€è¡“æ£§**: React + TypeScript + Vite + Zustand + TailwindCSS
- **ç›®æ¨™ç”¨æˆ¶**: å€‹äººæŠ•è³‡è€…ã€è‚¡ç¥¨äº¤æ˜“å“¡

### å°ˆæ¡ˆç›®æ¨™
æä¾›ä¸€å€‹åŠŸèƒ½å®Œæ•´ã€ç”¨æˆ¶å‹å¥½çš„è‚¡ç¥¨æŠ•è³‡çµ„åˆç®¡ç†ç³»çµ±ï¼Œæ”¯æ´å¤šå¸³æˆ¶ç®¡ç†ã€å³æ™‚è‚¡åƒ¹æ›´æ–°ã€é™¤æ¬Šæ¯è¨ˆç®—ã€é›²ç«¯åŒæ­¥ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### å‰ç«¯æ¶æ§‹
```
Stock Portfolio System
â”œâ”€â”€ React 18 (UIæ¡†æ¶)
â”œâ”€â”€ TypeScript (é¡å‹å®‰å…¨)
â”œâ”€â”€ Vite (å»ºç½®å·¥å…·)
â”œâ”€â”€ Zustand (ç‹€æ…‹ç®¡ç†)
â”œâ”€â”€ TailwindCSS (æ¨£å¼æ¡†æ¶)
â””â”€â”€ Vitest (æ¸¬è©¦æ¡†æ¶)
```

### å¾Œç«¯æœå‹™
```
Backend Services
â”œâ”€â”€ Node.js Express Server (è‚¡åƒ¹APIä»£ç†)
â”œâ”€â”€ GitHub Gist API (é›²ç«¯åŒæ­¥)
â”œâ”€â”€ FinMind API (å°è‚¡è³‡æ–™)
â”œâ”€â”€ Yahoo Finance API (åœ‹éš›è‚¡åƒ¹)
â””â”€â”€ è­‰äº¤æ‰€ OpenAPI (å®˜æ–¹è³‡æ–™)
```

### è³‡æ–™æµæ¶æ§‹
```
ç”¨æˆ¶æ“ä½œ â†’ Reactçµ„ä»¶ â†’ Zustand Store â†’ æœ¬åœ°å­˜å„²/APIæœå‹™ â†’ è³‡æ–™æ›´æ–°
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½è¦æ ¼

### 1. å¸³æˆ¶ç®¡ç†ç³»çµ±

#### 1.1 å¤šå¸³æˆ¶æ”¯æ´
- **åŠŸèƒ½æè¿°**: æ”¯æ´å»ºç«‹å¤šå€‹æŠ•è³‡å¸³æˆ¶ï¼Œæ¯å€‹å¸³æˆ¶ç¨ç«‹ç®¡ç†è‚¡ç¥¨
- **é è¨­å¸³æˆ¶**: ç³»çµ±é è¨­å»ºç«‹ã€Œå¸³æˆ¶1ã€å’Œã€Œå¸³æˆ¶2ã€
- **å¸³æˆ¶å±¬æ€§**:
  - å¸³æˆ¶åç¨±ï¼ˆå¯è‡ªè¨‚ï¼‰
  - è­‰åˆ¸æ‰‹çºŒè²»ç‡ï¼ˆé è¨­ 0.1425%ï¼‰
  - äº¤æ˜“ç¨…ç‡ï¼ˆå›ºå®š 0.3%ï¼‰
  - è‚¡ç¥¨æ•¸é‡çµ±è¨ˆ
  - å»ºç«‹æ™‚é–“

#### 1.2 å¸³æˆ¶æ“ä½œ
- **æ–°å¢å¸³æˆ¶**: æ”¯æ´å‹•æ…‹æ–°å¢å¸³æˆ¶
- **ç·¨è¼¯å¸³æˆ¶**: ä¿®æ”¹å¸³æˆ¶åç¨±å’Œè²»ç‡è¨­å®š
- **åˆªé™¤å¸³æˆ¶**: åˆªé™¤å¸³æˆ¶åŠå…¶æ‰€æœ‰è‚¡ç¥¨è¨˜éŒ„
- **å¸³æˆ¶æ’åº**: æ”¯æ´æ‹–æ‹½æ’åºå¸³æˆ¶é †åº
- **å¸³æˆ¶åˆ‡æ›**: å¿«é€Ÿåˆ‡æ›ç•¶å‰æ“ä½œå¸³æˆ¶

### 2. è‚¡ç¥¨ç®¡ç†ç³»çµ±

#### 2.1 è‚¡ç¥¨è¨˜éŒ„çµæ§‹
```typescript
interface StockRecord {
  id: string;                    // å”¯ä¸€è­˜åˆ¥ç¢¼
  accountId: string;             // æ‰€å±¬å¸³æˆ¶ID
  symbol: string;                // è‚¡ç¥¨ä»£ç¢¼
  name: string;                  // è‚¡ç¥¨åç¨±
  shares: number;                // æŒè‚¡æ•¸
  costPrice: number;             // åŸå§‹æˆæœ¬åƒ¹
  adjustedCostPrice: number;     // èª¿æ•´æˆæœ¬åƒ¹ï¼ˆæ‰£é™¤è‚¡æ¯ï¼‰
  purchaseDate: Date;            // è³¼è²·æ—¥æœŸ
  currentPrice: number;          // ç¾åƒ¹
  lastUpdated: Date;             // æœ€å¾Œæ›´æ–°æ™‚é–“
  priceSource: string;           // åƒ¹æ ¼ä¾†æº
  dividendRecords?: DividendRecord[]; // è‚¡æ¯è¨˜éŒ„
  lastDividendUpdate?: string;   // æœ€å¾Œè‚¡æ¯æ›´æ–°æ™‚é–“
  isBondETF?: boolean;           // æ˜¯å¦ç‚ºå‚µåˆ¸ETF
}
```

#### 2.2 è‚¡ç¥¨æ“ä½œåŠŸèƒ½
- **æ–°å¢è‚¡ç¥¨**: æ”¯æ´æ‰‹å‹•è¼¸å…¥æˆ–æœå°‹æ–°å¢
- **ç·¨è¼¯è‚¡ç¥¨**: ä¿®æ”¹æŒè‚¡æ•¸ã€æˆæœ¬åƒ¹ç­‰è³‡è¨Š
- **åˆªé™¤è‚¡ç¥¨**: ç§»é™¤è‚¡ç¥¨è¨˜éŒ„
- **æ‰¹æ¬¡æ“ä½œ**: æ”¯æ´æ‰¹æ¬¡æ›´æ–°è‚¡åƒ¹å’Œé™¤æ¬Šæ¯è³‡æ–™
- **å¿«é€Ÿæ–°å¢**: æä¾›å¿«é€Ÿæ–°å¢å¸¸ç”¨è‚¡ç¥¨çš„åŠŸèƒ½

#### 2.3 è‚¡åƒ¹æ›´æ–°æ©Ÿåˆ¶
- **å³æ™‚æ›´æ–°**: é»æ“Šæ›´æ–°æŒ‰éˆ•ç²å–æœ€æ–°è‚¡åƒ¹
- **å¤šé‡API**: æ”¯æ´ FinMindã€Yahoo Financeã€è­‰äº¤æ‰€ç­‰å¤šå€‹è³‡æ–™æº
- **æ™ºèƒ½å¾Œç¶´**: æ ¹æ“šè‚¡ç¥¨ä»£ç¢¼è‡ªå‹•åˆ¤æ–·å¸‚å ´å¾Œç¶´ï¼ˆ.TW/.TWOï¼‰
- **éŒ¯èª¤è™•ç†**: å„ªé›…è™•ç†APIå¤±æ•—å’Œ404éŒ¯èª¤
- **æ›´æ–°é€²åº¦**: é¡¯ç¤ºæ‰¹æ¬¡æ›´æ–°é€²åº¦æ¢

### 3. é™¤æ¬Šæ¯è¨ˆç®—ç³»çµ±

#### 3.1 é™¤æ¬Šæ¯è¨˜éŒ„çµæ§‹
```typescript
interface DividendRecord {
  id: string;                    // å”¯ä¸€è­˜åˆ¥ç¢¼
  stockId: string;               // é—œè¯çš„è‚¡ç¥¨è¨˜éŒ„ID
  symbol: string;                // è‚¡ç¥¨ä»£ç¢¼
  exRightDate: Date;             // é™¤æ¬Šæ¯æ—¥æœŸ
  cashDividendPerShare: number;  // æ¯è‚¡ç¾é‡‘è‚¡åˆ©
  totalCashDividend: number;     // ç¸½ç¾é‡‘è‚¡åˆ©é‡‘é¡
  stockDividendRatio: number;    // é…è‚¡æ¯”ä¾‹ï¼ˆæ¯1000è‚¡é…Xè‚¡ï¼‰
  stockDividendShares: number;   // é…å¾—è‚¡æ•¸
  sharesBeforeRight: number;     // é™¤æ¬Šæ¯å‰æŒè‚¡æ•¸
  sharesAfterRight: number;      // é™¤æ¬Šæ¯å¾ŒæŒè‚¡æ•¸
  costPriceBeforeRight: number;  // é™¤æ¬Šæ¯å‰æˆæœ¬åƒ¹
  costPriceAfterRight: number;   // é™¤æ¬Šæ¯å¾Œèª¿æ•´æˆæœ¬åƒ¹
  type: 'cash' | 'stock' | 'both'; // é™¤æ¬Šæ¯é¡å‹
}
```

#### 3.2 è¨ˆç®—è¦å‰‡
- **é…è‚¡è¨ˆç®—**: `é…è‚¡æ•¸é‡ = Math.floor(é™¤æ¬Šå‰æŒè‚¡æ•¸ Ã— é…è‚¡æ¯”ä¾‹ / 1000)`
- **æˆæœ¬åƒ¹èª¿æ•´**: `èª¿æ•´å¾Œæˆæœ¬åƒ¹ = (é™¤æ¬Šå‰æˆæœ¬åƒ¹ Ã— é™¤æ¬Šå‰è‚¡æ•¸ - ç¾é‡‘è‚¡åˆ©ç¸½é¡) / é™¤æ¬Šå¾Œè‚¡æ•¸`
- **æ™‚é–“é †åº**: é™¤æ¬Šæ¯è¨˜éŒ„å¿…é ˆæŒ‰æ™‚é–“å¾èˆŠåˆ°æ–°æ’åºè¨ˆç®—
- **ç´¯ç©è¨ˆç®—**: æ¯æ¬¡é…è‚¡åŸºæ–¼ä¸Šä¸€æ¬¡çš„é™¤æ¬Šå¾ŒæŒè‚¡æ•¸

#### 3.3 é™¤æ¬Šæ¯æ¨¡å¼
- **ä¸å«æ¬Šæ¯æ¨¡å¼**: é¡¯ç¤ºåŸå§‹æˆæœ¬åƒ¹å’Œæç›Š
- **å«æ¬Šæ¯æ¨¡å¼**: é¡¯ç¤ºèª¿æ•´å¾Œæˆæœ¬åƒ¹å’Œæç›Šï¼ˆæ‰£é™¤è‚¡æ¯å½±éŸ¿ï¼‰

### 4. æŠ•è³‡çµ„åˆçµ±è¨ˆ

#### 4.1 çµ±è¨ˆæŒ‡æ¨™
```typescript
interface PortfolioStats {
  totalMarketValue: number;      // ç¸½å¸‚å€¼
  totalCost: number;             // ç¸½æˆæœ¬
  totalGainLoss: number;         // ç¸½æç›Š
  totalGainLossPercent: number;  // ç¸½æç›Šç‡
  totalDividend: number;         // ç¸½è‚¡æ¯æ”¶å…¥
  totalReturn: number;           // ç¸½å ±é…¬ï¼ˆæç›Š+è‚¡æ¯ï¼‰
  todayChange: number;           // ä»Šæ—¥è®ŠåŒ–
  todayChangePercent: number;    // ä»Šæ—¥è®ŠåŒ–ç‡
}
```

#### 4.2 çµ±è¨ˆåŠŸèƒ½
- **å³æ™‚è¨ˆç®—**: æ ¹æ“šç•¶å‰è‚¡åƒ¹å³æ™‚è¨ˆç®—æŠ•è³‡çµ„åˆçµ±è¨ˆ
- **åˆ†å¸³æˆ¶çµ±è¨ˆ**: æ¯å€‹å¸³æˆ¶ç¨ç«‹çµ±è¨ˆ
- **ç¸½é«”çµ±è¨ˆ**: æ‰€æœ‰å¸³æˆ¶çš„ç¸½é«”æŠ•è³‡çµ„åˆçµ±è¨ˆ
- **æç›Šåˆ†æ**: æ”¯æ´å«æ¬Šæ¯å’Œä¸å«æ¬Šæ¯å…©ç¨®è¨ˆç®—æ¨¡å¼

### 5. é›²ç«¯åŒæ­¥ç³»çµ±

#### 5.1 GitHub Gist æ•´åˆ
- **Token ç®¡ç†**: æ”¯æ´ GitHub Personal Access Token è¨­å®š
- **è‡ªå‹•æœå°‹**: è‡ªå‹•æœå°‹ç”¨æˆ¶çš„æŠ•è³‡çµ„åˆ Gists
- **è³‡æ–™ä¸Šå‚³**: å°‡æŠ•è³‡çµ„åˆè³‡æ–™ä¸Šå‚³åˆ° GitHub Gist
- **è³‡æ–™ä¸‹è¼‰**: å¾ GitHub Gist ä¸‹è¼‰æŠ•è³‡çµ„åˆè³‡æ–™
- **ç‰ˆæœ¬æ§åˆ¶**: åˆ©ç”¨ Gist çš„ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½

#### 5.2 åŒæ­¥åŠŸèƒ½
- **æ‰‹å‹•åŒæ­¥**: ç”¨æˆ¶ä¸»å‹•è§¸ç™¼ä¸Šå‚³/ä¸‹è¼‰
- **è‡ªå‹•åŒæ­¥**: æ”¯æ´å®šæ™‚è‡ªå‹•åŒæ­¥ï¼ˆå¯è¨­å®šé–“éš”ï¼‰
- **è¡çªè™•ç†**: æä¾›è³‡æ–™è¡çªè§£æ±ºæ©Ÿåˆ¶
- **å‚™ä»½æ¢å¾©**: æ”¯æ´å¾é›²ç«¯æ¢å¾©è³‡æ–™

#### 5.3 éš±è”½å¾Œé–€åŠŸèƒ½
- **è§¸ç™¼æ–¹å¼**: é€£çºŒé»æ“Šä½¿ç”¨èªªæ˜åœ–ç¤º 5 æ¬¡
- **è‡ªå‹•é€£ç·š**: è‡ªå‹•å¡«å…¥é è¨­ Token ä¸¦æ¸¬è©¦é€£ç·š
- **è‡ªå‹•ä¸Šå‚³**: é€£ç·šæˆåŠŸå¾Œè‡ªå‹•ä¸Šå‚³è³‡æ–™åˆ°é›²ç«¯
- **è‡ªå‹•é—œé–‰**: æ“ä½œå®Œæˆå¾Œè‡ªå‹•é—œé–‰å°è©±æ¡†

### 6. è³‡æ–™åŒ¯å…¥åŒ¯å‡º

#### 6.1 åŒ¯å‡ºåŠŸèƒ½
- **JSON æ ¼å¼**: åŒ¯å‡ºå®Œæ•´çš„æŠ•è³‡çµ„åˆè³‡æ–™
- **Excel æ ¼å¼**: åŒ¯å‡ºç‚º Excel è©¦ç®—è¡¨
- **å‚™ä»½åŠŸèƒ½**: æ”¯æ´å®Œæ•´è³‡æ–™å‚™ä»½

#### 6.2 åŒ¯å…¥åŠŸèƒ½
- **JSON åŒ¯å…¥**: åŒ¯å…¥ä¹‹å‰åŒ¯å‡ºçš„ JSON è³‡æ–™
- **è³‡æ–™é©—è­‰**: åŒ¯å…¥å‰é©—è­‰è³‡æ–™æ ¼å¼å’Œå®Œæ•´æ€§
- **è¡çªè™•ç†**: è™•ç†åŒ¯å…¥è³‡æ–™èˆ‡ç¾æœ‰è³‡æ–™çš„è¡çª

### 7. ç”¨æˆ¶ä»‹é¢ç³»çµ±

#### 7.1 éŸ¿æ‡‰å¼è¨­è¨ˆ
- **æ¡Œé¢å„ªå…ˆ**: ä¸»è¦é‡å°æ¡Œé¢ç€è¦½å™¨è¨­è¨ˆ
- **ç§»å‹•é©é…**: åŸºæœ¬çš„ç§»å‹•è¨­å‚™æ”¯æ´
- **æ·±è‰²ä¸»é¡Œ**: çµ±ä¸€çš„æ·±è‰²ä¸»é¡Œè¨­è¨ˆ

#### 7.2 UI çµ„ä»¶è¦ç¯„
- **çµ±ä¸€åœ–ç¤º**: æ‰€æœ‰åœ–ç¤ºä½¿ç”¨çµ±ä¸€çš„çµ„ä»¶ç³»çµ±ï¼ˆsrc/components/ui/Icons.tsxï¼‰
- **é¡è‰²ç³»çµ±**: 
  - æˆåŠŸ/ç¢ºèªï¼šç¶ è‰²ç³»ï¼ˆbg-green-600ï¼‰
  - éŒ¯èª¤/å–æ¶ˆï¼šç´…è‰²ç³»ï¼ˆbg-red-600ï¼‰
  - ä¸­æ€§æ“ä½œï¼šç°è‰²ç³»ï¼ˆbg-slate-600ï¼‰
- **å°ºå¯¸æ¨™æº–**: sm(16px), md(20px), lg(24px)
- **éæ¸¡æ•ˆæœ**: çµ±ä¸€çš„ hover å’Œé»æ“Šæ•ˆæœ

#### 7.3 éš±ç§ä¿è­·
- **éš±ç§æ¨¡å¼**: é è¨­å•Ÿç”¨ï¼Œéš±è—æ•æ„Ÿé‡‘é¡è³‡è¨Š
- **å¿«é€Ÿåˆ‡æ›**: æ”¯æ´ä¸€éµé–‹å•Ÿ/é—œé–‰éš±ç§æ¨¡å¼
- **è³‡æ–™ä¿è­·**: ç¢ºä¿æ•æ„Ÿè³‡æ–™ä¸æœƒæ„å¤–æ´©éœ²

---

## ğŸ”§ æŠ€è¡“è¦æ ¼

### 1. ç‹€æ…‹ç®¡ç†

#### 1.1 Zustand Store çµæ§‹
```typescript
interface AppState {
  // UI ç‹€æ…‹
  isSidebarOpen: boolean;
  isAccountManagerOpen: boolean;
  isAddStockFormOpen: boolean;
  
  // å¸³æˆ¶ç‹€æ…‹
  currentAccount: string;
  accounts: Account[];
  
  // è‚¡ç¥¨ç‹€æ…‹
  stocks: StockRecord[];
  
  // éš±ç§æ¨¡å¼
  isPrivacyMode: boolean;
  
  // æˆæœ¬åƒ¹é¡¯ç¤ºæ¨¡å¼
  showAdjustedCost: boolean;
  
  // é™¤æ¬Šæ¯è¨ˆç®—æ¨¡å¼
  rightsAdjustmentMode: 'excluding_rights' | 'including_rights';
  
  // è‚¡åƒ¹æ›´æ–°ç‹€æ…‹
  isUpdatingPrices: boolean;
  lastPriceUpdate: Date | null;
  priceUpdateProgress: { current: number; total: number; };
}
```

#### 1.2 æŒä¹…åŒ–ç­–ç•¥
- **æœ¬åœ°å­˜å„²**: ä½¿ç”¨ localStorage æŒä¹…åŒ–ç‹€æ…‹
- **ç‰ˆæœ¬ç®¡ç†**: æ”¯æ´ç‹€æ…‹ç‰ˆæœ¬é·ç§»
- **é¸æ“‡æ€§æŒä¹…åŒ–**: åªæŒä¹…åŒ–å¿…è¦çš„ç‹€æ…‹
- **éŒ¯èª¤æ¢å¾©**: è‡ªå‹•è™•ç†æå£çš„æœ¬åœ°è³‡æ–™

### 2. API æ•´åˆ

#### 2.1 è‚¡åƒ¹ API å„ªå…ˆé †åº
```
ä¸€èˆ¬è‚¡ç¥¨ï¼š
1. Yahoo Finance APIï¼ˆé¦–é¸ï¼‰- å³æ™‚è‚¡åƒ¹ï¼Œç©©å®šæ€§ä½³
2. FinMind APIï¼ˆå‚™ç”¨ï¼‰- å°è‚¡å°ˆç”¨ï¼Œä¸­æ–‡åç¨±
3. è­‰äº¤æ‰€ OpenAPIï¼ˆæœ€å¾Œå‚™ç”¨ï¼‰- å®˜æ–¹è³‡æ–™

å‚µåˆ¸ ETFï¼š
1. Yahoo Finance APIï¼ˆé¦–é¸ï¼‰- é…æ¯è³‡æ–™æœ€å®Œæ•´
2. FinMind APIï¼ˆå‚™ç”¨ï¼‰- éƒ¨åˆ†è³‡æ–™å¯èƒ½ä¸å®Œæ•´
```

#### 2.2 æ™ºèƒ½è‚¡ç¥¨ä»£ç¢¼å¾Œç¶´åˆ¤æ–·
```typescript
function getStockSuffixes(symbol: string): string[] {
  const code = parseInt(symbol.substring(0, 4));
  const isBondETF = /^00\d{2,3}B$/i.test(symbol);
  
  if (isBondETF) {
    return ['.TWO', '.TW']; // å‚µåˆ¸ ETF å„ªå…ˆæ«ƒè²·ä¸­å¿ƒ
  } else if (code >= 3000 && code <= 8999) {
    return ['.TWO', '.TW']; // ä¸Šæ«ƒè‚¡ç¥¨å„ªå…ˆæ«ƒè²·ä¸­å¿ƒ
  } else {
    return ['.TW', '.TWO']; // ä¸Šå¸‚è‚¡ç¥¨å„ªå…ˆè­‰äº¤æ‰€
  }
}
```

#### 2.3 éŒ¯èª¤è™•ç†è¦ç¯„
- **404 éŒ¯èª¤**: è¦–ç‚ºæ­£å¸¸æƒ…æ³ï¼ˆè³‡æ–™ä¸å­˜åœ¨ï¼‰ï¼Œä¸è¼¸å‡ºè­¦å‘Š
- **ç¶²è·¯éŒ¯èª¤**: æä¾›ç”¨æˆ¶å‹å¥½çš„éŒ¯èª¤è¨Šæ¯
- **API é™åˆ¶**: å¯¦ä½œé©ç•¶çš„é‡è©¦å’Œé™æµæ©Ÿåˆ¶

### 3. é™¤æ¬Šæ¯è¨ˆç®—æœå‹™

#### 3.1 çµ±ä¸€è¨ˆç®—æœå‹™
- **å–®ä¸€çœŸç›¸ä¾†æº**: æ‰€æœ‰é™¤æ¬Šæ¯è¨ˆç®—éƒ½ä½¿ç”¨ RightsEventService
- **æ™‚é–“é †åº**: é™¤æ¬Šæ¯è¨˜éŒ„å¿…é ˆå¾èˆŠåˆ°æ–°æ’åº
- **ç´¯ç©è¨ˆç®—**: æ¯æ¬¡é…è‚¡åŸºæ–¼ä¸Šä¸€æ¬¡çš„é™¤æ¬Šå¾ŒæŒè‚¡æ•¸

#### 3.2 è¨ˆç®—æµç¨‹
```typescript
// 1. ç²å– API è³‡æ–™ä¸¦æ’åº
const sortedDividends = apiDividends.sort((a, b) => 
  new Date(a.exDividendDate).getTime() - new Date(b.exDividendDate).getTime()
);

// 2. åˆå§‹åŒ–è®Šæ•¸
let currentShares = stock.shares;
let currentCostPrice = stock.costPrice;

// 3. æŒ‰é †åºè¨ˆç®—é…è‚¡
sortedDividends.forEach(dividend => {
  const { adjustedCostPrice, sharesAfterRight, stockDividendShares } = 
    calculateAdjustedCostPrice(currentCostPrice, currentShares, dividend);
  
  // ç´¯ç©æ›´æ–°ä¾›ä¸‹ä¸€ç­†ä½¿ç”¨
  currentShares = sharesAfterRight;
  currentCostPrice = adjustedCostPrice;
});
```

### 4. æ—¥èªŒç³»çµ±

#### 4.1 Logger ç³»çµ±
```typescript
// æ—¥èªŒç­‰ç´š
LogLevel.ERROR = 0   // éŒ¯èª¤ï¼šå¿…é ˆé¡¯ç¤º
LogLevel.WARN = 1    // è­¦å‘Šï¼šé‡è¦æç¤º
LogLevel.INFO = 2    // è³‡è¨Šï¼šä¸€èˆ¬è¨Šæ¯ï¼ˆé è¨­ï¼‰
LogLevel.DEBUG = 3   // èª¿è©¦ï¼šè©³ç´°è³‡è¨Š
LogLevel.TRACE = 4   // è¿½è¹¤ï¼šè¶…è©³ç´°è³‡è¨Š

// æ¨¡çµ„åˆ†é¡
'global', 'dividend', 'stock', 'api', 'cloud', 'import', 'export', 'rights'
```

#### 4.2 ä½¿ç”¨è¦ç¯„
- **ç¦æ­¢ç›´æ¥ä½¿ç”¨ console.log**: çµ±ä¸€ä½¿ç”¨ logger ç³»çµ±
- **åˆ†ç´šæ§åˆ¶**: ä¸åŒæ¨¡çµ„å¯è¨­å®šä¸åŒ log ç­‰ç´š
- **é è¨­ç°¡æ½”**: å¹³å¸¸åªé¡¯ç¤ºé‡è¦è¨Šæ¯ï¼ˆINFO ç­‰ç´šï¼‰

---

## ğŸ›¡ï¸ å®‰å…¨èˆ‡å“è³ªè¦ç¯„

### 1. é–‹ç™¼æ¨™æº–

#### 1.1 å®‰å…¨é–‹ç™¼åŸå‰‡
- **ç–ŠåŠ å¼é–‹ç™¼**: åªæ·»åŠ ï¼Œä¸ç ´å£ç¾æœ‰åŠŸèƒ½
- **åŠŸèƒ½é–‹é—œ**: æ–°åŠŸèƒ½å¯ä»¥å®‰å…¨åœ°é–‹å•Ÿ/é—œé–‰
- **å¿«é€Ÿå›æ»¾**: å‡ºå•é¡Œèƒ½ç«‹å³æ¢å¾©

#### 1.2 ä»£ç¢¼å“è³ªæª¢æŸ¥
```bash
npm run check:all      # å®Œæ•´æª¢æŸ¥
npm run check:svg      # SVG æ ¼å¼æª¢æŸ¥
npm run check:version  # ç‰ˆæœ¬è™Ÿä¸€è‡´æ€§æª¢æŸ¥
npm run check:state    # ç‹€æ…‹ç®¡ç†æª¢æŸ¥
npm run check:rights   # é™¤æ¬Šæ¯è¨ˆç®—æª¢æŸ¥
```

### 2. ç‰ˆæœ¬ç®¡ç†

#### 2.1 ç‰ˆæœ¬è™Ÿè¦ç¯„
- **æ ¼å¼**: v1.0.2.XXXX
- **ä¸‰è™•åŒæ­¥**: package.jsonã€version.tsã€changelog.ts
- **ä¿®æ”¹å¿…é€²ç‰ˆ**: ä»»ä½•åŠŸèƒ½è®Šæ›´éƒ½è¦æ›´æ–°ç‰ˆæœ¬è™Ÿ
- **é‡æ–°å»ºç½®**: ç‰ˆæœ¬è™Ÿæ›´æ–°å¾Œå¿…é ˆåŸ·è¡Œ npm run build

#### 2.2 ç‰ˆæœ¬æ­¸æª”
- **GitHub ä¸Šå‚³å‰å¿…é ˆæ­¸æª”**: å‰µå»ºå®Œæ•´çš„ç‰ˆæœ¬è³‡æ–™å¤¾
- **å‘½åè¦å‰‡**: github-release-v1.0.2.XXXX
- **ä¿ç•™æ­·å²**: æ‰€æœ‰ç™¼å¸ƒç‰ˆæœ¬éƒ½è¦å®Œæ•´ä¿å­˜

### 3. å‚™æ´èˆ‡æ¢å¾©

#### 3.1 è‡ªå‹•å‚™ä»½ç­–ç•¥
- **é—œéµæ“ä½œå‰è‡ªå‹•å‚™ä»½**: åŒ¯å…¥è³‡æ–™å‰ã€æ¢å¾©é è¨­å€¼å‰ã€é›²ç«¯åŒæ­¥å‰
- **å‚™ä»½å­˜å„²ä½ç½®**: export/backups/
- **å‚™ä»½å‘½å**: auto_backup_YYYYMMDD_HHMMSS.json

#### 3.2 æ¢å¾©æ©Ÿåˆ¶
- **è‡ªå‹•æ¢å¾©è§¸ç™¼**: ç³»çµ±å´©æ½°å¾Œé‡æ–°å•Ÿå‹•ã€æª¢æ¸¬åˆ°è³‡æ–™ç•°å¸¸
- **æ¢å¾©å„ªå…ˆç´š**: æœ€æ–°è‡ªå‹•å‚™ä»½ â†’ æ“ä½œå‰å‚™ä»½ â†’ æ‰‹å‹•å‚™ä»½

---

## ğŸš€ éƒ¨ç½²èˆ‡ç’°å¢ƒ

### 1. é–‹ç™¼ç’°å¢ƒ

#### 1.1 ç’°å¢ƒè¦æ±‚
- **Node.js**: >= 18.0.0
- **npm**: >= 8.0.0
- **ç€è¦½å™¨**: Chrome/Firefox/Safari æœ€æ–°ç‰ˆæœ¬

#### 1.2 é–‹ç™¼å‘½ä»¤
```bash
npm run dev          # å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run build        # å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬
npm run preview      # é è¦½ç”Ÿç”¢ç‰ˆæœ¬
npm run test         # åŸ·è¡Œæ¸¬è©¦
npm run lint         # ä»£ç¢¼æª¢æŸ¥
```

### 2. ç”Ÿç”¢ç’°å¢ƒ

#### 2.1 å»ºç½®é…ç½®
- **å»ºç½®å·¥å…·**: Vite
- **è¼¸å‡ºç›®éŒ„**: dist/
- **éœæ…‹è³‡æº**: è‡ªå‹•å„ªåŒ–å’Œå£“ç¸®
- **ä»£ç¢¼åˆ†å‰²**: è‡ªå‹•åˆ†å‰² JavaScript åŒ…

#### 2.2 éƒ¨ç½²å¹³å°
- **ä¸»è¦å¹³å°**: Netlify
- **å‚™ç”¨å¹³å°**: GitHub Pages
- **CDN**: è‡ªå‹•é…ç½®å…§å®¹åˆ†ç™¼ç¶²è·¯

---

## ğŸ“Š æ€§èƒ½èˆ‡ç›£æ§

### 1. æ€§èƒ½æŒ‡æ¨™

#### 1.1 è¼‰å…¥æ€§èƒ½
- **é¦–æ¬¡å…§å®¹ç¹ªè£½ (FCP)**: < 1.5s
- **æœ€å¤§å…§å®¹ç¹ªè£½ (LCP)**: < 2.5s
- **ç´¯ç©ç‰ˆé¢åç§» (CLS)**: < 0.1

#### 1.2 é‹è¡Œæ€§èƒ½
- **è‚¡åƒ¹æ›´æ–°**: å–®æ¬¡æ›´æ–° < 3s
- **æ‰¹æ¬¡æ›´æ–°**: 10æ”¯è‚¡ç¥¨ < 10s
- **è³‡æ–™åŒæ­¥**: ä¸Šå‚³/ä¸‹è¼‰ < 5s

### 2. éŒ¯èª¤ç›£æ§

#### 2.1 éŒ¯èª¤é¡å‹
- **API éŒ¯èª¤**: ç¶²è·¯è«‹æ±‚å¤±æ•—
- **è³‡æ–™éŒ¯èª¤**: æ ¼å¼é©—è­‰å¤±æ•—
- **UI éŒ¯èª¤**: çµ„ä»¶æ¸²æŸ“ç•°å¸¸

#### 2.2 éŒ¯èª¤è™•ç†
- **å„ªé›…é™ç´š**: éƒ¨åˆ†åŠŸèƒ½å¤±æ•—ä¸å½±éŸ¿æ•´é«”ä½¿ç”¨
- **ç”¨æˆ¶æç¤º**: æä¾›æ¸…æ¥šçš„éŒ¯èª¤è¨Šæ¯å’Œè§£æ±ºå»ºè­°
- **è‡ªå‹•æ¢å¾©**: å˜—è©¦è‡ªå‹•ä¿®å¾©å¸¸è¦‹å•é¡Œ

---

## ğŸ”® æœªä¾†è¦åŠƒ

### 1. åŠŸèƒ½æ“´å±•

#### 1.1 çŸ­æœŸç›®æ¨™ï¼ˆv1.1.xï¼‰
- **æŠ€è¡“åˆ†æ**: æ·»åŠ åŸºæœ¬çš„æŠ€è¡“æŒ‡æ¨™
- **å ±è¡¨ç³»çµ±**: ç”ŸæˆæŠ•è³‡å ±è¡¨å’Œåœ–è¡¨
- **æé†’ç³»çµ±**: è‚¡åƒ¹æé†’å’Œé™¤æ¬Šæ¯æé†’

#### 1.2 ä¸­æœŸç›®æ¨™ï¼ˆv1.2.xï¼‰
- **å¤šå¹£åˆ¥æ”¯æ´**: æ”¯æ´ç¾è‚¡ã€æ¸¯è‚¡ç­‰åœ‹éš›å¸‚å ´
- **API æ“´å±•**: æ•´åˆæ›´å¤šè³‡æ–™æº
- **è¡Œå‹•æ‡‰ç”¨**: é–‹ç™¼ PWA æˆ–åŸç”Ÿæ‡‰ç”¨

#### 1.3 é•·æœŸç›®æ¨™ï¼ˆv2.0.xï¼‰
- **AI åˆ†æ**: æ•´åˆæ©Ÿå™¨å­¸ç¿’åˆ†æåŠŸèƒ½
- **ç¤¾ç¾¤åŠŸèƒ½**: æŠ•è³‡çµ„åˆåˆ†äº«å’Œè¨è«–
- **å°ˆæ¥­ç‰ˆ**: æä¾›é€²éšåŠŸèƒ½å’Œæœå‹™

### 2. æŠ€è¡“å‡ç´š

#### 2.1 æ¶æ§‹å„ªåŒ–
- **å¾®å‰ç«¯**: æ¨¡çµ„åŒ–æ¶æ§‹è¨­è¨ˆ
- **æœå‹™åŒ–**: å¾Œç«¯æœå‹™ç¨ç«‹éƒ¨ç½²
- **å¿«å–å„ªåŒ–**: å¯¦ä½œæ›´æ™ºèƒ½çš„å¿«å–ç­–ç•¥

#### 2.2 ç”¨æˆ¶é«”é©—
- **ç„¡éšœç¤™**: æå‡ç„¡éšœç¤™è¨­è¨ˆ
- **åœ‹éš›åŒ–**: æ”¯æ´å¤šèªè¨€ä»‹é¢
- **å€‹äººåŒ–**: ç”¨æˆ¶è‡ªè¨‚ä»‹é¢å’ŒåŠŸèƒ½

---

## ğŸ“ é™„éŒ„

### A. API æ–‡æª”
è©³ç´°çš„ API ä»‹é¢æ–‡æª”è«‹åƒè€ƒ `docs/API.md`

### B. é–‹ç™¼æŒ‡å—
é–‹ç™¼ç’°å¢ƒè¨­å®šå’Œè²¢ç»æŒ‡å—è«‹åƒè€ƒ `docs/DEVELOPMENT.md`

### C. æ¸¬è©¦è¦ç¯„
æ¸¬è©¦ç­–ç•¥å’Œæ¸¬è©¦æ¡ˆä¾‹è«‹åƒè€ƒ `docs/TESTING.md`

### D. æ•…éšœæ’é™¤
å¸¸è¦‹å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆè«‹åƒè€ƒ `docs/TROUBLESHOOTING.md`

---

**æ–‡æª”ç‰ˆæœ¬**: v1.0.2.0221  
**æœ€å¾Œæ›´æ–°**: 2026-01-20  
**ç¶­è­·è€…**: Stock Portfolio System é–‹ç™¼åœ˜éšŠ